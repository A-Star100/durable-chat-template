<!doctype html>
<html lang="en">
  <head>
    <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta charset="utf-8" />
    <title>Durable Chat</title>
    <meta name="description" content="The ultimate chat room" />
    <meta name="author" content="Anirudh Sevugan (https://anirudhsevugan.me/)" />

    <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

    <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="stylesheet" href="css/normalize.css" />
    <link rel="stylesheet" href="css/skeleton.css" />
    <link rel="stylesheet" href="styles.css" />

    <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link rel="icon" type="image/ico" href="favicon.ico" />
    <script src="/dist/index.js" type="module"></script>
    
<!-- script defer (the defer is so it occurs after DOM has loaded -->
<script defer>
  window.addEventListener("DOMContentLoaded", () => {
    const path = window.location.pathname;

    if (path === "/") {
      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;

      const modal = document.createElement("div");
      modal.innerHTML = `
        <div style="
          position: fixed; top: 0; left: 0; width: 100%; height: 100%;
          background: rgba(0, 0, 0, 0.5); display: flex;
          align-items: center; justify-content: center; z-index: 1000;
        ">
          <div style="
            background: ${prefersDark ? '#1e1e1e' : 'white'};
            color: ${prefersDark ? '#f0f0f0' : '#000'};
            padding: 2em; border-radius: 8px;
            display: flex; flex-direction: column; gap: 1em;
            width: 300px;
          ">
            <h3>Join or Create Room</h3>
            <input type="text" id="room-input" placeholder="Room ID..." style="
              padding: 0.5em;
              background: ${prefersDark ? '#333' : '#fff'};
              color: ${prefersDark ? '#eee' : '#000'};
              border: 1px solid ${prefersDark ? '#555' : '#ccc'};
            " />
            <div style="display: flex; justify-content: space-between;">
              <button id="join-room" style="
                background: ${prefersDark ? '#444' : '#eee'};
                color: ${prefersDark ? '#fff' : '#000'};
                border: none; padding: 0.5em 1em; border-radius: 4px;
              ">Join</button>
              <button id="new-room" style="
                background: ${prefersDark ? '#666' : '#ddd'};
                color: ${prefersDark ? '#fff' : '#000'};
                border: none; padding: 0.5em 1em; border-radius: 4px;
              ">New Room</button>
            </div>
          </div>
        </div>
      `;
      document.body.appendChild(modal);

      modal.querySelector("#join-room").addEventListener("click", () => {
        const input = modal.querySelector("#room-input");
        const roomId = input.value.trim();
        if (roomId) {
          window.location.href = `/${encodeURIComponent(roomId)}`;
        }
      });

      modal.querySelector("#new-room").addEventListener("click", () => {
        modal.remove(); // Let the app handle room generation
      });
    }
  });
</script>

  </head>
  <body>
    <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <div class="container" style="width: 95%; height: 100%">
      <div class="row" style="height: 100%">
        <div class="one-third column" style="margin-top: 25%">
          <h4><b>Durable Chat</b></h4>
          <p>
            Chat with anyone, anywhere. Once you've finished creating/joining a room, you can share the link with anyone you want to chat with!
          </p>
        </div>
        <div class="two-thirds column" id="root"></div>
      </div>
    </div>

    <!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  </body>
</html>
